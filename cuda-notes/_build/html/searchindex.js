Search.setIndex({"alltitles": {"Acknowledgments": [[0, "acknowledgments"]], "Attention Pytorch Code.": [[4, "attention-pytorch-code"]], "Conclusion": [[4, "conclusion"]], "Contribute": [[0, "contribute"], [1, "contribute"]], "CuBLAS": [[3, "cublas"]], "CuBLAS Error": [[3, "cublas-error"]], "Cuda C++: Crawling, Walking And Running": [[0, null]], "Cuda Error Checking": [[1, "cuda-error-checking"]], "Entire code.": [[4, "entire-code"]], "Finding Maximum And Sum Of An Array.": [[3, "finding-maximum-and-sum-of-an-array"]], "Finding the row maximum of a (N,C) dimesnion array. N is a power of 2 and greater than 31.": [[3, "finding-the-row-maximum-of-a-n-c-dimesnion-array-n-is-a-power-of-2-and-greater-than-31"]], "Finding the row sum of a (N,C) dimesnion array. N is a power of 2 and greater than 31.": [[3, "finding-the-row-sum-of-a-n-c-dimesnion-array-n-is-a-power-of-2-and-greater-than-31"]], "Flash Attention - I": [[3, null]], "Flash Attention - II": [[4, null]], "Flash Attention Cuda Coda": [[4, "flash-attention-cuda-coda"]], "Flash Attention.": [[4, "flash-attention"]], "Function Prototype": [[3, "function-prototype"]], "GPU Intro": [[1, "gpu-intro"]], "GPU Kernels": [[1, "gpu-kernels"]], "Getting Started: Cuda C++": [[1, null]], "How This Code Reduces Time (Compared to Naive GPU code)": [[4, "how-this-code-reduces-time-compared-to-naive-gpu-code"]], "Instruction Dispatch and Memory": [[2, null]], "Lets write a program to find the max within an array of size = 32(wrap size).": [[3, "lets-write-a-program-to-find-the-max-within-an-array-of-size-32-wrap-size"]], "Lets write a program to find the max within an array whose size is a power of 2 and greater 31.": [[3, "lets-write-a-program-to-find-the-max-within-an-array-whose-size-is-a-power-of-2-and-greater-31"]], "Little bit about L1, L2 and global memory working": [[2, "little-bit-about-l1-l2-and-global-memory-working"]], "Miscellaneous Code": [[4, "miscellaneous-code"]], "More About Shared Memory": [[2, "more-about-shared-memory"]], "Pre-requisite": [[0, "pre-requisite"]], "Putting it all together: Vector Addition": [[1, "putting-it-all-together-vector-addition"]], "Setting up cuBLAS": [[3, "setting-up-cublas"]], "Shared Memory": [[2, "shared-memory"]], "Some Functions and Classes To Knoww": [[3, "some-functions-and-classes-to-knoww"]], "Some optimization tips to achieve maximum efficiency.": [[2, "some-optimization-tips-to-achieve-maximum-efficiency"]], "Step 0: Defining the inputs and outputs.": [[4, "step-0-defining-the-inputs-and-outputs"]], "Step 1 - Permute: Splitting the input qkv into q, k, v. By calling the permute kernel.": [[4, "step-1-permute-splitting-the-input-qkv-into-q-k-v-by-calling-the-permute-kernel"]], "Step 2 - Dot Product: Dot product of q and k to compute preattn.": [[4, "step-2-dot-product-dot-product-of-q-and-k-to-compute-preattn"]], "Step 3: SCALE and MASK.": [[4, "step-3-scale-and-mask"]], "Step 4: Softmax kernel.": [[4, "step-4-softmax-kernel"]], "Step 5: Ouput of attention matrix and V.": [[4, "step-5-ouput-of-attention-matrix-and-v"]], "Step 6: Last step, Unpermute Y.": [[4, "step-6-last-step-unpermute-y"]], "Streaming Multiprocessor and GPU features": [[1, "streaming-multiprocessor-and-gpu-features"]], "The Bottleneck: Why is Standard Attention Slow?": [[4, "the-bottleneck-why-is-standard-attention-slow"]], "The Vanilla Self-Attention: Math Refresher": [[4, "the-vanilla-self-attention-math-refresher"]], "Transfer Of Data from CPU to GPU.": [[1, "transfer-of-data-from-cpu-to-gpu"]], "Types of Memories": [[2, "types-of-memories"]], "What are Threads, Blocks and Grids?": [[1, "what-are-threads-blocks-and-grids"]], "Why I wrote this": [[0, "why-i-wrote-this"]], "Why coalesing matters?": [[2, "why-coalesing-matters"]], "Wrap And Wrap Scheduler": [[2, "wrap-and-wrap-scheduler"]], "Writing our first program": [[1, "writing-our-first-program"]], "cublasSgemmStridedBatched in CUDA": [[3, "cublassgemmstridedbatched-in-cuda"]], "cudaGetDeviceProperties()": [[3, "cudagetdeviceproperties"]], "cudaSetDevice()": [[3, "cudasetdevice"]]}, "docnames": ["00-landing-page", "01-getting-started", "02-instruction-dispatch-and-memory", "03-flash-attention-I", "04-flash-attention-II"], "envversion": {"sphinx": 62, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1}, "filenames": ["00-landing-page.md", "01-getting-started.md", "02-instruction-dispatch-and-memory.md", "03-flash-attention-I.md", "04-flash-attention-II.md"], "indexentries": {}, "objects": {}, "objnames": {}, "objtypes": {}, "terms": {"": [1, 2, 3, 4], "0": [1, 2, 3], "000": 1, "079": 4, "0f": [2, 4], "0th": [3, 4], "0x0000000f": 3, "0x0000ffff": 3, "0xffffffff": [3, 4], "1": [1, 2, 3], "10": [1, 2, 3, 4], "100": [1, 2, 4], "1023": 3, "10239": 3, "1024": [2, 3, 4], "1060": 2, "11": [1, 3], "11263": 3, "12": [1, 3, 4], "12287": 3, "125": 2, "127": 2, "128": [2, 4], "13": [1, 3], "13311": 3, "14": [1, 2, 3], "14335": 3, "15": [1, 3], "15359": 3, "159": 2, "16": [1, 2, 3, 4], "16383": 3, "17": [2, 3], "17407": 3, "18": [2, 3], "18431": 3, "19": 3, "19455": 3, "1e": 4, "1x5": 1, "2": [1, 2], "20": 3, "2047": 3, "20479": 3, "21": [1, 3], "21503": 3, "22": 3, "223": 2, "224": 2, "22527": 3, "23": [1, 2, 3], "233": 2, "23551": 3, "24": [2, 3], "24575": 3, "25": 3, "255": 2, "25599": 3, "256": [2, 3, 4], "26": 3, "26623": 3, "27": 3, "27647": 3, "28": 3, "28671": 3, "287": 2, "29": 3, "29695": 3, "3": [1, 2, 3], "30": 3, "3071": 3, "30719": 3, "31": [1, 2], "31429377": 4, "31743": 3, "32": [1, 2, 4], "32767": 3, "36": 2, "389000": 2, "3c": 4, "3f": 4, "3x": 4, "4": [1, 2, 3], "4095": 3, "454000": 2, "472000": 2, "480": 2, "4d": 4, "4f": 4, "5": [1, 2, 3], "50": 2, "511": 2, "5119": 3, "512": [2, 4], "523776": 3, "524800": 3, "525824": 3, "526848": 3, "527872": 3, "528896": 3, "529920": 3, "530944": 3, "531968": 3, "532992": 3, "534016": 3, "535040": 3, "536064": 3, "537088": 3, "538112": 3, "539136": 3, "540160": 3, "541184": 3, "542208": 3, "543232": 3, "544256": 3, "545280": 3, "546304": 3, "547328": 3, "548352": 3, "549376": 3, "550400": 3, "551424": 3, "552448": 3, "553472": 3, "554496": 3, "555520": 3, "5th": 1, "6": [2, 3], "6143": 3, "63": 3, "64": [1, 2, 3, 4], "642000": 2, "67": 4, "7": [1, 2, 3], "7167": 3, "768": 4, "79": 2, "8": [1, 2, 3, 4], "8191": 3, "8192": [2, 4], "9": 3, "9215": 3, "96": 2, "A": [1, 2, 3], "AND": 4, "And": [1, 4], "As": [0, 1, 2, 3, 4], "But": [1, 2], "By": 2, "For": [1, 2, 3, 4], "If": [0, 1, 2, 3, 4], "In": [1, 2, 3, 4], "It": [1, 2, 3, 4], "Its": [1, 2], "No": 3, "Not": 2, "One": [2, 3], "That": 4, "The": [0, 1, 2, 3], "Then": [1, 3, 4], "There": [0, 1], "These": [0, 1], "To": [1, 2], "Will": 1, "_": [2, 4], "__device__": 4, "__file__": [1, 2, 3, 4], "__global__": [1, 2, 3, 4], "__host__": 4, "__line__": [1, 2, 3, 4], "__shared__": [2, 3, 4], "__shfl_down_sync": [3, 4], "__shfl_xor_sync": 4, "__syncthread": [2, 3, 4], "a_shar": 2, "a_val": 2, "about": [0, 1, 3, 4], "abov": [0, 1, 2, 3, 4], "absent": 3, "absolut": 2, "abstract": 0, "acccess": 2, "acces": 2, "access": [1, 2, 3, 4], "accumul": [2, 4], "accur": 4, "accuraci": 4, "accuracy_threshold": 4, "achiev": 4, "across": [2, 3, 4], "action": 0, "activ": 3, "ad": 1, "add": [1, 2], "add_vector": [1, 2], "addit": [3, 4], "addr": 1, "address": [1, 2], "addtion": 1, "adjac": 2, "advanc": 4, "after": [0, 1, 2, 3, 4], "again": 2, "aggreg": 4, "al": 4, "algo": 2, "algorithm": [2, 4], "align": [2, 4], "all": [0, 2, 3, 4], "alloc": [1, 2, 3, 4], "allow": [2, 3, 4], "along": 4, "alpha": [3, 4], "alreadi": 2, "also": [1, 2, 3, 4], "alu": [1, 3], "alwai": [0, 1, 2, 3], "am": [0, 1, 2], "among": 2, "amount": 1, "amout": 2, "an": [0, 1, 2, 4], "andrej": [0, 3, 4], "angl": 1, "ani": [0, 1, 2, 3, 4], "anoth": [1, 2, 3, 4], "anyth": 1, "api": 3, "apolog": 0, "apologis": [0, 1], "appar": 4, "appli": 4, "applic": 3, "approach": 4, "ar": [0, 2, 3, 4], "architectur": 4, "argc": 4, "argument": [1, 2], "argv": 4, "arithmet": 1, "around": 1, "arr": 4, "arrai": [1, 2, 4], "arrang": 4, "articl": [0, 1], "asiz": 3, "asll": 2, "assemb": 1, "assembl": [1, 4], "assert": 4, "assign": 4, "associ": 3, "asssum": 1, "assum": [1, 2, 3, 4], "att": 4, "att_bth": 4, "att_btht2": 4, "attempt": [0, 2, 4], "attend": 4, "attent": 1, "attention_forward": 4, "attention_forward_cpu": 4, "attention_forward_cuda": 4, "attn": 4, "autoregress": 4, "avail": 2, "availab": 2, "avoid": [2, 4], "awai": 2, "awar": 4, "b": [1, 2, 3, 4], "b_share": 2, "b_val": 2, "back": [1, 2, 4], "balanc": 2, "bandwidth": 4, "barrier": 4, "base": [3, 4], "basic": [0, 2], "batch": [3, 4], "batch_siz": 3, "batchcount": 3, "beacaus": 4, "beacus": 4, "becaus": [1, 2, 3, 4], "becom": 4, "becuas": 3, "befor": [1, 3, 4], "begin": 2, "behavior": 3, "behind": 0, "being": [2, 4], "believ": 3, "belong": [1, 3], "below": [1, 2, 3, 4], "benchmark": 4, "benchmark_kernel": 4, "benefit": 0, "beta": [3, 4], "better": [0, 1, 2, 4], "between": [2, 3, 4], "bf16": 1, "bia": 4, "big": 4, "bit": [1, 4], "block": [2, 3, 4], "block_siz": [2, 3, 4], "blockdim": [1, 2, 3, 4], "blockid": 1, "blockidx": [1, 2, 3, 4], "blocks_per_grid": 1, "blog": [0, 3, 4], "boooom": 1, "both": [2, 3], "bound": 4, "bracket": 1, "break": 4, "broadcast": 4, "bu": 2, "buffer": 4, "build": [1, 4], "built": 4, "busi": 2, "byte": [1, 2, 3], "c": [2, 4], "c3": 4, "c_col": 4, "cach": [2, 4], "calcul": [2, 3, 4], "cale": 1, "call": [1, 2, 3], "can": [1, 2, 3, 4], "cannot": [1, 2], "capabl": [1, 2], "capac": 2, "case": [1, 2], "catch": 3, "causal": 4, "cc": 1, "cdot": [3, 4], "ceil_div": 4, "certain": 2, "chang": [1, 3], "chapter": [1, 2, 3, 4], "char": [1, 2, 3, 4], "check": [0, 2, 3, 4], "chip": 4, "choic": 0, "class": [1, 4], "clear": [2, 4], "clock": [1, 2], "clock_t": 2, "clocks_per_sec": 2, "closer": 4, "cmath": 4, "co": 1, "coalesc": [2, 4], "coarsen": [3, 4], "code": [0, 1, 2, 3], "collect": [1, 2], "column": [2, 3], "com": 4, "comb": 1, "combin": 4, "come": [1, 3, 4], "command": [1, 4], "common": 4, "commun": [1, 3, 4], "compar": 3, "comparison": 4, "compil": [1, 2], "complex": 4, "compli": 1, "complic": 4, "compon": [1, 4], "compris": [1, 2], "compromis": [3, 4], "comput": [1, 2, 3], "computation": 4, "concaten": 4, "concept": [0, 1, 2, 4], "conceptu": 4, "concurr": 2, "conjug": 3, "consecut": 2, "consid": 2, "consist": 1, "const": [1, 2, 3, 4], "consum": 2, "contain": 3, "content": 0, "context": 3, "contigi": 2, "contigu": [2, 4], "continu": 4, "control": [2, 3], "convert": 1, "coordin": 4, "copi": [1, 2], "core": [1, 4], "correct": [0, 1, 4], "correctli": 4, "correspond": [2, 3, 4], "cost": 4, "costli": [1, 2], "could": [0, 1, 4], "cout": [3, 4], "cover": [1, 4], "cpu": 4, "cpu_ref": 4, "cpu_refer": 4, "creat": [2, 3, 4], "crucial": 4, "cu": 4, "cube": 1, "cubla": 4, "cublas_default_math": 4, "cublas_handl": [3, 4], "cublas_math_mod": 4, "cublas_op_c": 3, "cublas_op_n": [3, 4], "cublas_op_t": [3, 4], "cublas_status_success": [3, 4], "cublas_tf32_tensor_op_math": 4, "cublas_v2": 4, "cublascheck": [3, 4], "cublascr": [3, 4], "cublasdestroi": [3, 4], "cublashandle_t": [3, 4], "cublasmath_t": 4, "cublasoperation_t": 3, "cublassetmathmod": 4, "cublassgemmstridedbatch": 4, "cublasstatus_t": [3, 4], "cuda": 2, "cuda_check": [1, 2, 4], "cuda_runtim": 3, "cudacheck": [1, 2, 3, 4], "cudadevicegetattribut": 3, "cudadeviceprop": [3, 4], "cudadevicesynchron": 1, "cudaerror_t": [1, 2, 3, 4], "cudaevent_t": 4, "cudaeventcr": 4, "cudaeventelapsedtim": 4, "cudaeventrecord": 4, "cudaeventsynchron": 4, "cudafre": [1, 3, 4], "cudagetdevic": 3, "cudagetdeviceproperti": 4, "cudageterrorstr": [1, 2, 4], "cudainitdevic": 3, "cudamalloc": [1, 2, 3, 4], "cudamemcpi": [1, 2, 3, 4], "cudamemcpydevicetohost": [1, 2, 3, 4], "cudamemcpyhosttodevic": [1, 2, 3, 4], "cudamemset": [3, 4], "cudasetdevic": 4, "cudasetvaliddevic": 3, "cudasuccess": [1, 2, 4], "cudasync": 2, "cudnn": 4, "curiou": 0, "current": [3, 4], "custom": 4, "cycl": [1, 2], "d": [1, 2, 3, 4], "d_": 4, "d_a": [1, 2, 3], "d_att": 4, "d_attn": 4, "d_b": [1, 2], "d_c": [1, 2, 3], "d_inp": 4, "d_k": 4, "d_out": 4, "d_preatt": 4, "d_preattn": 4, "d_qkvr": 4, "d_v": 4, "d_vaccum": 4, "dao": 4, "data": [2, 3, 4], "debug": 4, "decid": [0, 2, 3], "declar": 2, "decod": 4, "deconstruct": 4, "def": 4, "default": [1, 3], "defin": [1, 2, 3], "defualt": 0, "delai": [0, 1], "delta": 3, "demonstr": 3, "depend": [1, 2, 3, 4], "depict": 2, "desir": 1, "detail": 3, "devic": [1, 2, 3, 4], "device_result": 4, "deviceidx": [3, 4], "deviceprop": [3, 4], "did": [0, 1, 4], "didn": 0, "differ": [1, 2, 4], "dim": [1, 3, 4], "dim3": [1, 2], "dimens": [1, 3, 4], "dimension": [3, 4], "dimesnion": 1, "direct": [2, 4], "directli": [3, 4], "discuss": 3, "dispacht": 1, "dispatch": 4, "displai": 1, "dive": 1, "divid": [1, 4], "dividend": 4, "divis": 4, "divisor": 4, "do": [0, 1, 2, 3, 4], "document": [0, 3], "doe": [0, 1, 2, 3, 4], "doesn": 2, "domin": 4, "don": [2, 3], "done": [1, 2, 4], "dot": [2, 3], "doubl": [1, 2, 3], "down": [2, 3, 4], "dp": 1, "draft": 0, "dram": [1, 2], "drastic": 4, "driver": 3, "dsize": 2, "dual": [1, 2], "due": 2, "dummi": 4, "dure": [2, 3, 4], "dynam": [2, 4], "e": [3, 4], "each": [0, 1, 2, 3, 4], "easi": 4, "educ": 0, "effect": 4, "effici": [3, 4], "either": 3, "elapsed_tim": 4, "element": [2, 3, 4], "elementwis": 4, "els": [1, 4], "embed": 4, "emploi": 4, "enable_bf16": 4, "enable_tf32": 4, "endif": 4, "endl": 3, "enough": 2, "ensur": 4, "entir": 1, "entiti": 1, "entri": 4, "epsilon": 4, "equal": 4, "err": [1, 2, 4], "error": [2, 4], "especi": 4, "et": 4, "etc": [1, 2], "even": 4, "event": 3, "everi": [3, 4], "everyon": 3, "everyth": 2, "ex": 4, "exact": 4, "exampl": [1, 2, 3, 4], "excecut": 1, "except": 3, "exceut": 1, "exclus": 3, "execut": [1, 2, 3, 4], "exit": [1, 2, 3, 4], "exit_failur": [1, 2, 3, 4], "exp": 4, "expect": [3, 4], "expertis": 0, "expf": 4, "explain": 3, "explan": [1, 3], "explanatori": 4, "explic": 1, "explicit": 4, "explicitli": [3, 4], "exploit": 4, "exponenti": 4, "expsum": 4, "expsum_inv": 4, "expv": 4, "extern": [2, 3, 4], "extra": 2, "extrem": 4, "f": [2, 4], "fab": 4, "fact": [1, 2], "fall": 2, "far": [1, 2], "fashion": 4, "fast": [2, 4], "faster": 4, "fastest": 2, "featur": 4, "fetch": 2, "few": 4, "fewer": 4, "fig": 2, "figur": [1, 2, 3], "file": [1, 2, 3, 4], "final": [3, 4], "find": [0, 1, 2, 4], "findmax": 3, "finish": [1, 3], "first": [0, 2, 3, 4], "fit": 2, "five": 2, "flash": 1, "flash_attent": 4, "flash_attention_blog": 4, "flashattent": 4, "float": [1, 2, 3, 4], "flt_epsilon": 4, "flt_max": 4, "flush": 4, "flush_buff": 4, "fly": 4, "fmaxf": 4, "follow": [0, 1], "follwo": 3, "form": 4, "formul": 4, "forward": 4, "found": 3, "four": 2, "fp16": [1, 4], "fp32": 4, "fp4": 1, "fp6": 1, "fp8": 1, "frac": 4, "free": [0, 1, 4], "from": [0, 2, 3, 4], "full": [2, 4], "function": [1, 4], "function_nam": 1, "funtion": 4, "further": [2, 4], "furthermor": 4, "fuse": 4, "fusion": 4, "futur": 4, "g": 4, "gb": 1, "gemm": 4, "gemmstridedbatch": 3, "gener": 4, "get": [2, 3, 4], "gird": 1, "github": [0, 1], "give": [0, 1, 2, 3, 4], "given": [2, 3, 4], "global": [1, 3, 4], "globali": 2, "go": [0, 1, 2, 3, 4], "goal": 4, "goe": 4, "good": 1, "gourp": 1, "gpt": [3, 4], "gpu": [0, 2, 3], "gradient": 4, "grammat": 0, "grid": 2, "grid_siz": 4, "griddim": 1, "ground": [3, 4], "group": [1, 2], "guess": 1, "guid": 3, "h": [1, 2, 3, 4], "h_": 1, "h_a": [1, 2, 3], "h_b": [1, 2], "h_c": [1, 2, 3], "ha": [1, 2, 3, 4], "had": 0, "half": 4, "handl": [2, 3, 4], "happen": [1, 2, 3, 4], "happend": 3, "hardwar": [1, 2, 4], "have": [0, 1, 2, 3, 4], "hbm": 4, "head": 4, "headdim": 4, "help": [0, 1, 2, 4], "henc": 1, "here": [0, 1, 2, 3, 4], "hidden": 2, "hierarchi": [1, 4], "high": 4, "higher": 4, "highli": 4, "hope": 2, "host": [1, 2, 3, 4], "how": [1, 2, 3], "howev": 4, "http": 4, "huge": 4, "i": [1, 2], "id": [1, 3, 4], "idea": [1, 2, 3, 4], "ideal": 4, "identifi": [1, 2, 3], "idi": 2, "idx": [2, 3, 4], "ie": [1, 2], "ifndef": 4, "ij": 4, "imag": 2, "implement": 4, "implemet": 4, "implicit": 4, "implicitli": 3, "import": [1, 4], "improv": 4, "includ": [1, 2, 3, 4], "incorrect": 3, "independ": [1, 2, 4], "index": [1, 2, 3, 4], "indic": [1, 4], "individu": 3, "inf": [3, 4], "infin": 4, "info": [2, 3, 4], "inform": [3, 4], "infti": 4, "inisid": 1, "init": 2, "initi": [1, 2, 3], "initial": [1, 3], "inner": 2, "inp": [3, 4], "inp_idx": 4, "inp_idx_k": 4, "inp_idx_q": 4, "inp_idx_v": 4, "input": [1, 2, 3], "insid": [0, 1, 2, 3], "instanc": 3, "instead": [2, 3, 4], "instruct": [1, 3, 4], "int": [1, 2, 3, 4], "int8": 1, "int_min": 3, "intens": 4, "inter": [3, 4], "intermedi": 4, "intern": 4, "internet": 0, "interpret": 3, "intra": [3, 4], "intruct": 2, "invalid": 2, "iostream": [3, 4], "isfinit": 4, "isn": 4, "isol": 3, "issu": [0, 1, 2, 4], "iter": [2, 3, 4], "ithi": 3, "its": [1, 2, 3, 4], "itself": 4, "j": [3, 4], "jointli": 4, "journei": 4, "junk": 3, "just": [1, 4], "k": [2, 3], "karpathi": [0, 3, 4], "keep": [2, 3, 4], "kei": 4, "kept": 4, "kernel": [2, 3], "kernel3": 4, "kernel_arg": 4, "kernelarg": 4, "key_idx": 4, "key_t2": 4, "keyword": 2, "kind": 2, "kindli": [0, 1], "know": [0, 1, 2, 3, 4], "knowledg": 0, "known": 1, "kv": 4, "l2": 4, "l2caches": 4, "land": 1, "lane": 3, "laneid": [3, 4], "languag": 1, "larg": [1, 2, 4], "last": 3, "lastli": 2, "latenc": [2, 4], "later": [1, 2], "latter": 4, "launch": [1, 2, 3, 4], "launcha": 4, "layer": 4, "layout": 4, "lcubla": 4, "ld": 1, "lda": 3, "ldb": 3, "ldc": 3, "lead": 3, "learn": [0, 1], "leav": 2, "lectur": 2, "left": 3, "length": 4, "less": [1, 2, 3, 4], "let": [1, 2, 4], "level": 3, "leverag": 4, "librari": [3, 4], "like": [1, 2, 4], "limit": [2, 3], "line": [1, 2, 3, 4], "linear": 4, "linearli": 4, "link": [1, 2], "list": 3, "litt": 2, "llm": 0, "load": [1, 2, 4], "local": 4, "locat": 4, "lock": 3, "logic": [3, 4], "long": 3, "look": 4, "loop": 2, "loos": 1, "loss": 4, "lot": [0, 3, 4], "lower": 4, "lru": 2, "m": [3, 4], "m_": 4, "machin": 1, "made": [3, 4], "mai": [1, 2, 3, 4], "main": [0, 1, 2, 3, 4], "major": 4, "majorli": [0, 2], "make": [1, 2, 3, 4], "make_random_float": 4, "malloc": [1, 4], "manag": 4, "mani": [1, 2], "mannual": 2, "manual": [2, 4], "mask": 3, "masked_fil": 4, "match": 4, "mathemat": [3, 4], "matirx": 2, "matmul": 4, "matric": [3, 4], "matrix": [2, 3], "matter": 0, "max": 4, "max_result": 3, "max_val": [3, 4], "max_valu": 3, "maxim": [2, 4], "maximum": 4, "maxval": [3, 4], "me": 0, "mean": [1, 2, 3, 4], "mechan": [3, 4], "memomri": [2, 4], "memori": [1, 3, 4], "memset": 4, "mention": [0, 1, 2], "might": [0, 1, 2, 3, 4], "million": 4, "min": 4, "mind": 3, "minim": 4, "mismatch": [2, 4], "mistak": [0, 1], "mmul": 2, "mode": 3, "model": [3, 4], "modifi": 2, "more": [1, 3, 4], "most": [3, 4], "move": 4, "movement": 4, "much": [2, 4], "multi": 4, "multipl": [1, 2, 3, 4], "multipli": [1, 2, 3, 4], "must": [3, 4], "my": [0, 1], "n": [1, 2, 4], "n_embd": 4, "n_head": 4, "naiv": 2, "name": 4, "nanosecond": 1, "neccessari": [2, 4], "necessari": 4, "necessarili": 1, "need": [1, 2, 3, 4], "neg": 4, "neighbour": 2, "never": 4, "new": [2, 4], "next": [1, 2, 4], "nfault": 4, "nh": 4, "nh_": 4, "none": 2, "nor": 1, "normal": [1, 4], "note": [0, 1, 2, 3, 4], "notic": 1, "now": [1, 2, 3, 4], "nullptr": 4, "num_block": 4, "num_el": 4, "number": [1, 2, 3, 4], "numer": 4, "numhead": 4, "nvbench": 4, "nvcc": [1, 4], "nvidia": [0, 1, 3, 4], "o": 4, "observ": 1, "occupi": 1, "occur": 3, "offer": 3, "offeset": 3, "offici": 3, "offset": [3, 4], "often": [2, 3, 4], "okai": 4, "old": 2, "onc": [2, 3], "one": [1, 2, 3, 4], "ones": 4, "onli": [1, 2, 3, 4], "onlin": 4, "op": 3, "opcod": 1, "openmp": 1, "oper": [1, 2, 3, 4], "operand": 1, "optim": 4, "optimis": 2, "option": [3, 4], "order": 1, "orderli": 2, "ordin": 1, "origin": 4, "other": [0, 1, 2, 3], "other_idx": 4, "otherwis": 3, "ouput": 2, "our": [2, 3, 4], "out": [2, 3, 4], "out_bth": 4, "out_gpu": 4, "outer": 2, "output": [1, 2, 3], "outsid": 4, "over": [2, 4], "overal": 2, "overflow": 4, "overhead": 4, "overlap": 3, "ow": 0, "p": 4, "p_": 4, "pack": 4, "pad": [2, 4], "pai": 4, "paper": 4, "paral": [1, 3], "parallel": 1, "paramet": [1, 2, 3], "part": [1, 3, 4], "particip": 3, "particukar": 1, "particular": [1, 2, 3], "particularli": 4, "partit": 3, "pass": [1, 3, 4], "pattern": 4, "peak": 4, "pemut": 4, "per": [1, 2, 3, 4], "perfect": 2, "perform": [1, 3, 4], "permute_kernel": 4, "person": 0, "pic": 1, "pictur": [1, 3], "piec": 4, "pipelin": 2, "place": 3, "playlist": 0, "pleas": [0, 1, 2, 3, 4], "plu": 4, "point": [1, 2, 4], "pointer": [1, 3, 4], "poor": 2, "posit": [3, 4], "possibli": 0, "post": 4, "potenti": 4, "practic": 1, "pre": 4, "preatt": 4, "preatt_bth": 4, "preciou": 0, "precis": [1, 4], "prepar": 4, "present": [1, 2, 3, 4], "prevent": 4, "previou": [2, 3, 4], "previous": 1, "primari": 3, "prime": 4, "primit": [3, 4], "print": [1, 4], "printcor": 1, "printf": [1, 2, 3, 4], "priorit": 3, "probabl": 4, "proce": 4, "process": [1, 2, 3, 4], "produc": 4, "product": [2, 3], "program": [0, 2], "programm": 2, "prohibit": 3, "project": 4, "properti": 3, "provid": [0, 2, 3, 4], "ptx": 1, "purpos": [2, 4], "put": [2, 4], "pv": 4, "pytorch": 0, "qk": 4, "qkvr": 4, "quad": 3, "queri": [3, 4], "query_idx": 4, "query_t": 4, "question": 4, "quickli": 4, "rais": [0, 1], "ram": [1, 4], "rand": 4, "rand_max": 4, "random": 4, "rang": 4, "raw": 4, "re": 4, "reach": [2, 4], "read": [2, 4], "reader": 0, "realli": [0, 1], "realtiv": 2, "rearrang": 4, "recal": [3, 4], "recap": 4, "recommend": 4, "recomput": 4, "reconstruct": 4, "record": 4, "reduc": 3, "reduct": [2, 3, 4], "refer": 1, "refernc": 2, "regard": 2, "region": [2, 4], "regist": [1, 4], "releas": 3, "remain": [3, 4], "remeb": 2, "rememb": [2, 3], "reorder": 2, "repeat": 4, "repeat_tim": 4, "repo": 0, "repres": [1, 3, 4], "represent": 4, "request": [1, 2, 3, 4], "requir": [2, 4], "reserv": 2, "resgist": 1, "reshap": 4, "resort": 3, "resourc": [0, 1, 2, 3], "respect": [1, 2], "respons": [0, 1, 4], "rest": [2, 4], "result": [1, 2, 3, 4], "return": [2, 3, 4], "reus": 2, "right": 1, "round": 4, "routin": 4, "row": [2, 4], "row_sum": 3, "run": [1, 2, 3, 4], "runtim": 3, "s_": 4, "sadli": 2, "safer": 4, "sai": [1, 2, 3], "sake": 3, "same": [1, 2, 3, 4], "samplefunct": 2, "sass": 1, "satur": 2, "saw": 4, "scalar": 3, "scale_kernel": 4, "scenario": 2, "scheduer": 2, "schedul": [1, 4], "score": 4, "scratch": 4, "scrub": 4, "sec": 1, "second": [1, 2, 3, 4], "section": 3, "see": [1, 2, 3, 4], "seen": [1, 2, 3, 4], "self": 3, "send": 1, "sens": 1, "sentenc": 2, "separ": [1, 4], "sequenc": 4, "sequencelength": 4, "sequenti": 1, "seri": [0, 3, 4], "servic": 4, "set": 4, "setup": 4, "sever": [2, 4], "shape": 4, "share": [0, 1, 3, 4], "shared_mem_s": 4, "shared_memory_in_byt": 2, "shift": 3, "should": [0, 2, 3, 4], "show": 1, "shuffl": [3, 4], "side": 4, "significantli": 4, "similar": [1, 3, 4], "simpli": [1, 2], "simplifi": 4, "simultan": 3, "sinc": [0, 2, 3], "singl": [1, 2, 4], "single_cal": 4, "size": [1, 2, 4], "size_t": 4, "sizeof": [1, 2, 3, 4], "skip": 4, "slow": 1, "slower": 4, "sm": [1, 2], "small": 4, "smaller": 4, "smallest": 1, "so": [0, 1, 2, 3, 4], "softmax_block_s": 4, "softmax_forward_kernel": 4, "softmax_forward_kernel4": 4, "softwar": 1, "some": [1, 4], "someon": 0, "someth": 4, "soon": [0, 1, 3], "sophist": 4, "sorri": 1, "sourc": 4, "sp": 1, "space": [3, 4], "special": [1, 3, 4], "specif": [3, 4], "specifi": [1, 2, 3, 4], "speed": [1, 2, 4], "spread": 2, "sqrt": 4, "sqrtf": 4, "sram": 4, "st": 1, "stabil": 4, "stabl": 4, "stackoverflow": 4, "stage": 4, "stai": 2, "standard": 1, "standpoint": 1, "star": [0, 1], "start": [2, 3, 4], "statu": [3, 4], "std": [3, 4], "stdio": [1, 2, 3, 4], "stdlib": 4, "stop": 4, "storag": 2, "store": [1, 2, 3, 4], "straight": 1, "strateg": 4, "strategi": 4, "stream": [3, 4], "strictli": 4, "stride": 4, "stridea": 3, "strideb": 3, "stridec": 3, "strive": 2, "stumbl": 0, "style": 4, "sub": [1, 4], "subject": 0, "subsequ": [2, 3, 4], "subspac": 4, "subtract": 4, "success": [1, 2, 4], "suffic": 3, "sum": [2, 4], "sum_val": 4, "sumval": 4, "support": 3, "suppos": 2, "sure": [2, 3], "switch": 2, "synchron": [2, 4], "syntax": 1, "system": 3, "t": [0, 1, 2, 3, 4], "t0": 2, "t1": [2, 4], "t1sum": 2, "t2": [2, 4], "t2sum": 2, "t_cpu_add": 1, "t_eff": 4, "t_gpu_add": 1, "take": [0, 1, 2, 4], "taken": [2, 3], "target": 4, "task": 4, "techniqu": 4, "tell": [1, 2], "temp": 2, "templat": 4, "temporarili": 4, "tensor": [1, 4], "term": [1, 2], "text": [3, 4], "tf32": 4, "th": [2, 4], "than": [1, 2, 4], "thank": [0, 1], "them": [1, 2, 4], "thi": [1, 2, 3], "thing": 4, "think": 1, "third": [1, 2], "thisshar": 3, "those": 4, "thread": [2, 3, 4], "threadblock": 2, "threadd": 2, "threadid": [1, 3], "threadidx": [1, 2, 3, 4], "threads_per_block": [1, 3], "three": [1, 2], "three_c": 4, "threshold": 4, "through": [3, 4], "throughput": 2, "throw": [1, 2], "ti": 2, "tid": [3, 4], "tile": 4, "till": 1, "time": [0, 1, 2, 3], "tlb": 4, "todo": 4, "togeth": [2, 4], "token": 4, "toler": 4, "too": 4, "took": 2, "torch": 4, "total": [1, 2, 4], "total_sum": 4, "total_thread": 4, "toward": 4, "track": [2, 4], "traffic": 4, "train": [0, 3, 4], "transa": 3, "transact": 4, "transb": 3, "transfer": 2, "transfererd": 1, "translat": [1, 4], "transpos": [3, 4], "tri": 2, "tril": 4, "tripl": 1, "true": [1, 4], "try": [2, 3, 4], "turn": 3, "twice": 1, "two": [1, 2, 3, 4], "type": [1, 3], "typic": 4, "u": [1, 2], "undefin": 3, "under": 2, "underflow": 4, "understand": [0, 1, 2, 4], "uniqu": [1, 4], "unit": 1, "unpermute_kernel": 4, "unsign": 3, "until": 1, "up": [2, 4], "updat": 3, "upon": 0, "us": [0, 1, 2, 3, 4], "usag": 4, "user": 4, "usual": 4, "util": [2, 4], "utiliaz": 2, "utilis": 2, "vaccum": 4, "val": [3, 4], "valid": [2, 3], "validate_result": 4, "valu": [3, 4], "value_t2": 4, "var": 3, "variabl": 4, "variou": [1, 4], "ve": 4, "vector": 4, "vector_add": 2, "veri": [1, 2, 3, 4], "verifi": 0, "version": 4, "via": [2, 4], "video": [3, 4], "view": [1, 4], "visul": 1, "void": [1, 2, 3, 4], "wa": [0, 1, 2], "wai": [2, 4], "wait": 1, "want": [1, 2, 4], "warp": [1, 2, 3, 4], "warpid": [3, 4], "warpreducemax": [3, 4], "warpreducesum": [3, 4], "warpsiz": 3, "warpsperblock": [3, 4], "wast": [0, 1], "we": [1, 2, 3, 4], "websit": 0, "weight": 4, "well": [0, 3], "went": 2, "what": [0, 2, 3], "whatev": [0, 1], "when": [1, 2, 3, 4], "whenev": [1, 3], "where": [1, 2, 3, 4], "wherev": 3, "whether": 3, "which": [0, 1, 2, 3, 4], "while": [1, 2, 4], "who": 0, "whole": 4, "why": [1, 3], "wide": [2, 3, 4], "width": 3, "wil": 3, "wise": 4, "within": [1, 2, 4], "without": [2, 3, 4], "won": [1, 4], "word": 1, "work": [0, 1, 3], "would": [1, 3], "wrap": [1, 4], "write": [0, 2, 4], "written": [0, 1, 4], "wrote": 1, "x": [1, 2, 3, 4], "x_i": 4, "x_j": 4, "y": [1, 2], "yet": 0, "you": [0, 1, 2, 3, 4], "your": [0, 1], "yourself": 1, "yt": 0, "z": 1, "zero": [2, 3, 4], "zeroth": 1}, "titles": ["Cuda C++: Crawling, Walking And Running", "Getting Started: Cuda C++", "Instruction Dispatch and Memory", "Flash Attention - I", "Flash Attention - II"], "titleterms": {"0": 4, "1": 4, "2": [3, 4], "3": 4, "31": 3, "32": 3, "4": 4, "5": 4, "6": 4, "And": [0, 2, 3], "By": 4, "Of": [1, 3], "The": 4, "To": 3, "about": 2, "achiev": 2, "acknowledg": 0, "addit": 1, "all": 1, "an": 3, "ar": 1, "arrai": 3, "attent": [3, 4], "bit": 2, "block": 1, "bottleneck": 4, "c": [0, 1, 3], "call": 4, "check": 1, "class": 3, "coales": 2, "coda": 4, "code": 4, "compar": 4, "comput": 4, "conclus": 4, "contribut": [0, 1], "cpu": 1, "crawl": 0, "cubla": 3, "cublassgemmstridedbatch": 3, "cuda": [0, 1, 3, 4], "cudagetdeviceproperti": 3, "cudasetdevic": 3, "data": 1, "defin": 4, "dimesnion": 3, "dispatch": 2, "dot": 4, "effici": 2, "entir": 4, "error": [1, 3], "featur": 1, "find": 3, "first": 1, "flash": [3, 4], "from": 1, "function": 3, "get": 1, "global": 2, "gpu": [1, 4], "greater": 3, "grid": 1, "how": 4, "i": [0, 3, 4], "ii": 4, "input": 4, "instruct": 2, "intro": 1, "k": 4, "kernel": [1, 4], "knoww": 3, "l1": 2, "l2": 2, "last": 4, "let": 3, "littl": 2, "mask": 4, "math": 4, "matrix": 4, "matter": 2, "max": 3, "maximum": [2, 3], "memori": 2, "miscellan": 4, "more": 2, "multiprocessor": 1, "n": 3, "naiv": 4, "optim": 2, "ouput": 4, "our": 1, "output": 4, "permut": 4, "power": 3, "pre": 0, "preattn": 4, "product": 4, "program": [1, 3], "prototyp": 3, "put": 1, "pytorch": 4, "q": 4, "qkv": 4, "reduc": 4, "refresh": 4, "requisit": 0, "row": 3, "run": 0, "scale": 4, "schedul": 2, "self": 4, "set": 3, "share": 2, "size": 3, "slow": 4, "softmax": 4, "some": [2, 3], "split": 4, "standard": 4, "start": 1, "step": 4, "stream": 1, "sum": 3, "than": 3, "thi": [0, 4], "thread": 1, "time": 4, "tip": 2, "togeth": 1, "transfer": 1, "type": 2, "unpermut": 4, "up": 3, "v": 4, "vanilla": 4, "vector": 1, "walk": 0, "what": 1, "whose": 3, "why": [0, 2, 4], "within": 3, "work": 2, "wrap": [2, 3], "write": [1, 3], "wrote": 0, "y": 4}})